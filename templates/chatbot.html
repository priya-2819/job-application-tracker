<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Career Assistant | Civora Nexus</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #e3f2fd, #ffffff);
            font-family: 'Poppins', sans-serif;
            height: 100vh;
            margin: 0;
            display: flex;
            flex-direction: column;
        }
        .chat-container {
            max-width: 700px;
            margin: auto;
            background: #fff;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            height: 80vh;
            overflow: hidden;
        }
        .chat-header {
            background: #0d6efd;
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 1.3rem;
            font-weight: bold;
        }
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f8f9fa;
            display: flex;
            flex-direction: column;
        }
        .chat-bubble {
            max-width: 75%;
            padding: 10px 15px;
            border-radius: 15px;
            margin-bottom: 10px;
            animation: fadeIn 0.4s ease-in-out;
        }
        .user-msg {
            background: #0d6efd;
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 0;
        }
        .bot-msg {
            background: #e9ecef;
            color: #212529;
            align-self: flex-start;
            border-bottom-left-radius: 0;
        }
        .typing {
            display: inline-block;
            background: #e9ecef;
            color: transparent;
            height: 16px;
            width: 40px;
            border-radius: 20px;
            position: relative;
            margin-bottom: 10px;
            align-self: flex-start;
        }
        .typing::before, .typing::after, .typing span {
            content: '';
            display: block;
            position: absolute;
            top: 5px;
            width: 6px;
            height: 6px;
            background: #6c757d;
            border-radius: 50%;
            animation: blink 1.4s infinite;
        }
        .typing::before {
            left: 8px;
            animation-delay: 0s;
        }
        .typing span {
            left: 18px;
            animation-delay: 0.2s;
        }
        .typing::after {
            left: 28px;
            animation-delay: 0.4s;
        }
        @keyframes blink {
            0%, 80%, 100% { opacity: 0.3; }
            40% { opacity: 1; }
        }
        .chat-input {
            display: flex;
            padding: 10px;
            background: #fff;
            border-top: 1px solid #ddd;
        }
        .chat-input input {
            flex: 1;
            border-radius: 20px;
            padding: 10px 15px;
            border: 1px solid #ccc;
            outline: none;
        }
        .chat-input button {
            margin-left: 10px;
            border-radius: 20px;
            padding: 10px 20px;
        }
        @keyframes fadeIn {
            from {opacity: 0; transform: translateY(10px);}
            to {opacity: 1; transform: translateY(0);}
        }
    </style>
</head>
<body>
    {% include 'navbar.html' %}

    <div class="chat-container mt-4">
        <div class="chat-header">ðŸ’¬ Career Assistant</div>

        <div class="chat-messages" id="chat-box">
            {% for msg in chat_history %}
                <div class="chat-bubble user-msg">{{ msg.user }}</div>
                <div class="chat-bubble bot-msg">{{ msg.bot }}</div>
            {% endfor %}
        </div>

        <form method="POST" class="chat-input" id="chat-form">
            {% csrf_token %}
            <input type="text" name="message" id="chat-message" placeholder="Type your question..." required>
            <button class="btn btn-primary" type="submit">Send</button>
        </form>
    </div>

    <script>
        const chatBox = document.getElementById('chat-box');
        const form = document.getElementById('chat-form');
        const input = document.getElementById('chat-message');

        chatBox.scrollTop = chatBox.scrollHeight;

        // Add typing animation on form submit
        form.addEventListener("submit", function() {
            let typingDiv = document.createElement("div");
            typingDiv.className = "typing";
            let span = document.createElement("span");
            typingDiv.appendChild(span);
            chatBox.appendChild(typingDiv);
            chatBox.scrollTop = chatBox.scrollHeight;
        });
    </script>
</body>
</html>
